# 덱 시스템 기획

## 개요

전투 중 자원(마나)의 운용, 덱의 순환 구조, 카드 핸드/드로우 규칙을 다룬다.

## 관련 문서

- [전투 시스템](../Combat/CombatSystem.md) - 전투 진행 흐름
- [카드 시스템](Card.md) - 카드 분류, 등급, 강화, 키워드
- [영웅 시스템](../Global/Hero.md) - 카드 시전 주체, 영웅 위치 기반 효과

---

## 1. 마나 시스템

- 마나는 시간 경과에 따라 자동으로 **누적**됨 (초당 일정량 획득)
- 전투 시작 시 마나 0에서 시작
- 상한선이 존재하며, 상한 도달 시 더 이상 누적되지 않음
- 카드를 사용하면 해당 카드의 비용만큼 차감
- 적 유닛 처치 시 해당 적의 벨류에 비례한 마나를 획득
- 마나가 부족하면 카드 사용 불가 (UI에서 비활성 표시)

---

## 2. 덱 순환 구조

전투 중 카드는 3개의 더미를 순환한다.

```
[Draw Pile] → 드로우 → [Hand] → 사용 → [Discard Pile]
     ↑                                       |
     └──── 덱 소진 시 셔플하여 재구성 ────────┘
```

| 더미 | 설명 |
|------|------|
| **Draw Pile** | 아직 뽑지 않은 카드. 전투 시작 시 현재 덱을 셔플하여 생성 |
| **Hand** | 현재 손에 들고 있는 카드. 여기서 카드를 사용 |
| **Discard Pile** | 사용하거나 버린 카드. Draw Pile 소진 시 셔플하여 새 Draw Pile이 됨 |

---

## 3. 핸드 & 드로우

- 전투 시작 시 초기 핸드 드로우
- 최대 핸드 사이즈: **10장**

### 3.1 리드로우

핸드 갱신은 자동 드로우가 아닌 **플레이어의 리드로우 조작**으로 이루어진다.

- 리드로우 시 현재 핸드를 **전부 버리는 더미로 이동**시킨 뒤, 뽑는 더미에서 새 핸드를 드로우
- 쿨타임이 충전되면 리드로우 가능, 쿨타임 중에는 사용 불가
- 쿨타임은 리드로우 사용 시 초기화되어 다시 충전 시작

| 항목 | 설명 |
|------|------|
| 비용 | 없음 (쿨타임만 소모) |
| 드로우 장수 | 최대 핸드 사이즈만큼 |
| 쿨타임 | 전투 상수로 관리 |

> 핸드 사이즈, 초기 드로우 수, 리드로우 쿨타임, 마나 회복 속도 등 전투 상수는 `GameConstants` 코드 파일에서 일괄 관리한다.

---

## 4. 카드 사용

핸드에서 카드를 드래그하여 필드에 드롭하면 사용된다.

| 카드 타입 | 사용 방식 |
|-----------|-----------|
| 유닛 카드 | 사용 시 화면 왼쪽 가장자리에서 유닛 출현 |
| 스펠 카드 | 영웅 위치 기준으로 대상/범위 지정 또는 즉시 발동 |

- 사용된 카드는 Discard Pile로 이동
- 드래그 중 핸드로 되돌리면 사용 취소

### 이펙트(VFX)

| 상황 | 이펙트 |
|------|--------|
| 카드 사용 | 카드가 빛나며 필드로 이동하는 연출 |
| 스펠 시전 | 스펠 종류별 고유 이펙트 (화염구, 번개 등) |

---

## 5. 덱 관리 화면

```
┌─────────────────────────────────────────┐
│  내 덱 (15장)                            │
│  [전체] [유닛] [스펠]              │
│  정렬: [비용순] [등급순] [이름순]         │
│                                         │
│  ┌────┐ ┌────┐ ┌────┐ ┌────┐ ┌────┐  │
│  │    │ │    │ │    │ │    │ │    │  │
│  └────┘ └────┘ └────┘ └────┘ └────┘  │
│  ┌────┐ ┌────┐ ┌────┐ ┌────┐ ┌────┐  │
│  │    │ │    │ │    │ │    │ │    │  │
│  └────┘ └────┘ └────┘ └────┘ └────┘  │
│  ┌────┐ ┌────┐ ┌────┐ ┌────┐ ┌────┐  │
│  │    │ │    │ │    │ │    │ │    │  │
│  └────┘ └────┘ └────┘ └────┘ └────┘  │
│                                         │
│  [닫기]                                  │
└─────────────────────────────────────────┘
```

- 카드 클릭 시 상세 정보 팝업
- 필터/정렬 기능으로 카드 검색
- 맵 화면에서 언제든 접근 가능
